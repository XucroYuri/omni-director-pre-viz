# 风险审计清单（2026）

## 1. 目的
用于指导“可删与不可删”的取舍，避免在重构中误删关键链路。

## 2. 高风险项（必须保留或先加固）

### 不可删
1. 任务状态机与租约机制
- 涉及 `queued/running/completed/failed/cancelled`、lease/heartbeat/recovery。
- 删除或弱化会直接造成重复执行、任务丢失或假成功。

2. 结构化错误码分层
- `TASK_PAYLOAD_MISSING / TASK_ENTITY_NOT_FOUND / TASK_PRECONDITION_FAILED / TASK_EXECUTION_FAILED` 等。
- 直接关联 `TaskPanel` 可读文案与排障效率。

3. dead-letter 与审计日志主链路
- 包含批量重试、跳过原因、批次摘要。
- 是线上故障复盘与修复闭环的唯一证据链。

### 可删（前提：完成替代验证）
1. 旧 Electron 专用临时适配层
- 条件：Web First 主链路稳定且迁移完成。

2. 重复的手动上报路径
- 条件：自动 worker 执行链路覆盖率达到回归门禁。

## 3. 中风险项（可收敛）

### 不可直接删
1. 兼容字段与兼容接口
- 先确认没有 UI/API 调用方再移除。

2. 队列运维页面的筛选参数
- 若删减需先评估对排障流程的影响。

### 可删
1. 已过时的 Phase 注释和重复文档说明
- 保留一份权威说明即可。

2. 无调用的 helper/mapper
- 需通过静态检索 + 回归测试双重确认。

## 4. 低风险项（优先清理）
1. 历史临时脚本（已无入口、无 CI 使用）。
2. 重复文档段落、旧计划副本、失效 TODO。
3. 仅用于一次性排障的调试日志文本。

## 5. 执行闸门（Delete Gate）
每次删除或收敛逻辑前必须满足：
1. 有替代链路或明确“无需替代”的证明。
2. 至少一条自动回归覆盖关键行为。
3. 失败时可快速回滚（保留最小补丁路径）。
4. 变更说明写入本目录文档或 PR 描述。

## 6. 本轮建议优先顺序
1. 先清理低风险文档与重复说明。
2. 再收敛中风险死路径（先静态确认，再回归）。
3. 高风险项仅做“可观测性加固”，不做激进删除。
